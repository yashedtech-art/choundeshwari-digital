<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHOUNDESHWARI DIGITAL - Gallery</title>
<style>
body { font-family:'Segoe UI', sans-serif; padding:20px; background:#f5f7fa; }
h1 { text-align:center; color:#1a237e; margin-bottom:20px; }
.gallery { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:15px; }
.gallery img { width:100%; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.2); cursor:pointer; transition:0.3s; }
.gallery img:hover { transform:scale(1.05); }
button.download { margin-top:5px; padding:8px 10px; background:#667eea; color:white; border:none; border-radius:6px; cursor:pointer; }
#msg { text-align:center; margin-top:20px; color:red; }
</style>
</head>
<body>
<h1>Your Photos</h1>
<div class="gallery" id="gallery"></div>
<p id="msg"></p>

<script>
const galleryDiv = document.getElementById("gallery");
const msg = document.getElementById("msg");

// Get customer folder from URL
const params = new URLSearchParams(window.location.search);
const folder = params.get("folder");

if (!folder) {
    msg.innerText = "No folder specified.";
} else {
    // Fetch photos.json for this customer
    fetch(`customers/${folder}/photos.json`)
    .then(res => res.json())
    .then(photos => {
        if(photos.length === 0) {
            msg.innerText = "No photos available.";
            return;
        }
        photos.forEach(photo => {
            const div = document.createElement("div");
            div.innerHTML = `
                <img src="customers/${folder}/${photo}" alt="Photo">
                <button class="download" onclick="downloadPhoto('${folder}','${photo}')">Download</button>
            `;
            galleryDiv.appendChild(div);
        });
    })
    .catch(err => {
        console.error(err);
        msg.innerText = "Cannot load photos.";
    });
}

// Download function
function downloadPhoto(folder, photo) {
    const link = document.createElement("a");
    link.href = `customers/${folder}/${photo}`;
    link.download = photo;
    link.click();
}
</script>
</body>
</html>